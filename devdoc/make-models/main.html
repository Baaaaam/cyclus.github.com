


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developing Models For Cyclus &mdash; Cyclus Home</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Cyclus Home" href="../../index.html" />
    <link rel="up" title="Cyclus Developer Guide" href="../main.html" />
    <link rel="next" title="Developing Region Models" href="facility.html" />
    <link rel="prev" title="Style Guidelines for Developers" href="../style_guide.html" />
   
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12222727-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
  <a href="http://cyclus.github.com">
    <img src="../../_static/logo1.png"/>
  </a>
</div>


    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="facility.html" title="Developing Region Models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../style_guide.html" title="Style Guidelines for Developers"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Cyclus Home</a> &raquo;</li>
          <li><a href="../main.html" accesskey="U">Cyclus Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developing Models For Cyclus</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#creating-new-models-of-the-existing-types">Creating New Models of the Existing Types</a></li>
<li><a class="reference internal" href="#creating-specific-model-types">Creating Specific Model Types</a><ul>
<li><a class="reference internal" href="#a-note-to-core-developers">A Note To Core Developers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extending-loadable-modules-to-other-types-outdated">Extending Loadable Modules to Other Types (outdated)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../style_guide.html"
                        title="previous chapter">Style Guidelines for Developers</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="facility.html"
                        title="next chapter">Developing Region Models</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="developing-models-for-cyclus">
<h1>Developing Models For Cyclus<a class="headerlink" href="#developing-models-for-cyclus" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Cyclus core has support for Markets, Facilities, Institutions, and Regions.
The instructions here will describe both how to add specific modules of those types,
as well as how to extend Cyclus to other types of loadable modules.</p>
</div>
<div class="section" id="creating-new-models-of-the-existing-types">
<h2>Creating New Models of the Existing Types<a class="headerlink" href="#creating-new-models-of-the-existing-types" title="Permalink to this headline">¶</a></h2>
<p>For each type of model (i.e. Market, Facility, Institution, or Region), a set of stub
files are available as skeletons for the new models.  When creating a new model, it is important that all the
functionality defined in these files remains in the final model definition. A
step by step example of producing a new model from the existing stubs can be
found in the Toaster Example <a class="reference internal" href="toaster.html"><em>Model Devlopment Example : ToasterFacility</em></a></p>
</div>
<div class="section" id="creating-specific-model-types">
<h2>Creating Specific Model Types<a class="headerlink" href="#creating-specific-model-types" title="Permalink to this headline">¶</a></h2>
<p>For further details about creating new models of particular types, consult the
Model-specific reference:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="facility.html">Developing Region Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="facility.html#details">Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="institution.html">Developing Institution Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="institution.html#details">Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="region.html">Developing Region Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="region.html#details">Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="region.html#to-do">To Do</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="market.html">Developing Market Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="market.html#details">Details</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="a-note-to-core-developers">
<h3>A Note To Core Developers<a class="headerlink" href="#a-note-to-core-developers" title="Permalink to this headline">¶</a></h3>
<p>It is very important to keep the Stub files in the Models directory (or in each
of the model sub-directories) current.  As the Model.h definition is
improved/enhanced/developed, each of the model types will have to be updated to
be consistent.  Treat the StubModel and the StubCommModel in the same way as
others to ensure it remains up-to-date.</p>
<p>Similarly if a single model type is updated, e.g. MarketModel.h, with new
capability, each of the implemented models will need to be updated to be
consistent.  Treat the Stub`*` Models in each sub-directory in the same way as
the others to ensure it remains up-to-date.</p>
</div>
</div>
<div class="section" id="extending-loadable-modules-to-other-types-outdated">
<h2>Extending Loadable Modules to Other Types (outdated)<a class="headerlink" href="#extending-loadable-modules-to-other-types-outdated" title="Permalink to this headline">¶</a></h2>
<p>The current code already has support for loadable modules for MarketModel,
FacilityModel, InstModel, and RegionModel. These are all derived from base
class Model defined in <cite>src/Models/Model.h</cite>.  To support extension of this
capability to other types of models, the files <cite>src/Models/StubModel.h</cite> &amp;
<cite>src/Models/StubModel.cpp</cite> is provided.  (Stubs are also provided for new
Models that are also Communicators: <cite>src/Models/StubCommModel.h</cite> &amp;
<cite>src/Models/StubCommModel.cpp</cite>.)</p>
<p>To extend to a new model type, e.g. NewTypeModel:</p>
<blockquote>
<div><ul>
<li><p class="first">copy StubModel.h &amp; StubModel.cpp to a new location, NewTypeModel.h &amp;
NewTypeModel.cpp, respectively</p>
</li>
<li><p class="first">change the internal references to StubModel to NewTypeModel</p>
</li>
<li><p class="first">add NewTypeModel.cpp to the list of sources in the top level CMakeLists.txt file</p>
</li>
<li><p class="first">add a sub-directory (e.g. NewType) to the Models directory for your models</p>
<blockquote>
<div><ul class="simple">
<li>this directory name will become a keyword and should match the model name</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">create a StubNewType.h and StubNewType.cpp file in that sub-directory that
are stubs for new models of that type (you may want to copy the files
Stub/StubStub.h and Stub/StubStub.cpp)</p>
<blockquote>
<div><ul class="simple">
<li>follow the directions for creating a new model above to make a Stub for
your NewType model</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>All new models types must include:</p>
<blockquote>
<div><ul>
<li><p class="first">a default constructor that</p>
<blockquote>
<div><ul class="simple">
<li>assigns the current value of nextID to the ID member variable and
increments nextID</li>
<li>assigns a string that matches the model name to <cite>model_type</cite></li>
<li>(for Communicators, this should also assign the correct value to
<cite>commType</cite>)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">a method named &#8216;init&#8217; to initialize an instance of the model from an XML
node pointer (xmlNodePtr)</p>
<blockquote>
<div><ul class="simple">
<li>this method must call the parent class method Model::init(cur)</li>
<li>this method should only initialize variables that are NOT members of the
parent class</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">a method named &#8216;copy&#8217; to initialize an instance of the model from another
instance of the same model</p>
<blockquote>
<div><ul class="simple">
<li>this method must call the parent class method Model::copy(src)</li>
<li>(for Communicators, this method must call that parent class method
Communicator::copy(src))</li>
<li>this method should only initialize variables that are NOT members of the
parent class</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">a method named &#8216;print&#8217; to print a description of the model</p>
<blockquote>
<div><ul class="simple">
<li>this method should call the parent class method of the same name (e.g.
MarketModel::print())</li>
<li>this method should only print information that is NOT part of the parent
class(es)</li>
<li>this method assumes that a dangling output line (no std::endl) is left
from the parent class output</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Other notes on introducing new Model types:</p>
<blockquote>
<div><ul class="simple">
<li>You will probably need to extend the input parsing for this new Model type.
Since the primary input for <em>Cyclus</em> uses XML, you will certainly need to
add code to recognize and process primitives for this Model type.  While
you could, in theory, add a completely new input paradigm for Models of
this type, you might need to extend the <em>Cyclus</em> grammar to include support
for your Models.</li>
<li>You will probably need to create a primary storage location for your new
models in <em>Cyclus</em>.  Currently, most models are somehow registered with the
Logician (exception: InstModel are only registered with their containing
Region). You will need to extend the code appropriately to give a home to
your new models.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><ol class="arabic simple">
<li><a class="reference external" href="http://oss.sgi.com/LDP/HOWTO/C++-dlopen/index.html">C++ dlopen mini HOWTO</a></li>
<li><a class="reference external" href="http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html">Static, Shared Dynamic and Loadable Linux Libraries</a></li>
</ol>
</div></blockquote>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="facility.html" title="Developing Region Models"
             >next</a> |</li>
        <li class="right" >
          <a href="../style_guide.html" title="Style Guidelines for Developers"
             >previous</a> |</li>
        <li><a href="../../index.html">Cyclus Home</a> &raquo;</li>
          <li><a href="../main.html" >Cyclus Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Robert Carlsen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>