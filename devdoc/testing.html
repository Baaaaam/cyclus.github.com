


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Writing Tests for Modules &mdash; Cyclus Home</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Cyclus Home" href="../index.html" />
    <link rel="up" title="Cyclus Developer Guide" href="main.html" />
    <link rel="next" title="Using the Cyclus Logger" href="logger.html" />
    <link rel="prev" title="Model Devlopment Example : ToasterFacility" href="make-models/toaster.html" />
   
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12222727-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
  <a href="http://cyclus.github.com">
    <img src="../_static/logo1.png"/>
  </a>
</div>


    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="logger.html" title="Using the Cyclus Logger"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="make-models/toaster.html" title="Model Devlopment Example : ToasterFacility"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Cyclus Home</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Cyclus Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Writing Tests for Modules</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#directory-structure">Directory Structure</a></li>
<li><a class="reference internal" href="#testing-framework">Testing Framework</a></li>
<li><a class="reference internal" href="#an-example">An Example</a><ul>
<li><a class="reference internal" href="#module-h">Module.h</a></li>
<li><a class="reference internal" href="#module-cpp">Module.cpp</a></li>
<li><a class="reference internal" href="#moduletests-h">ModuleTests.h</a></li>
<li><a class="reference internal" href="#moduletests-cpp">ModuleTests.cpp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-xml-initialization">Testing XML Initialization</a><ul>
<li><a class="reference internal" href="#id1">Module.h</a></li>
<li><a class="reference internal" href="#id2">Module.cpp</a></li>
<li><a class="reference internal" href="#id3">ModuleTests.h</a></li>
<li><a class="reference internal" href="#id4">ModuleTests.cpp</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="make-models/toaster.html"
                        title="previous chapter">Model Devlopment Example : ToasterFacility</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="logger.html"
                        title="next chapter">Using the Cyclus Logger</a></p>
  <h3>Useful Pages</h3>
    <li><a href="http://cyclus.github.com/basics/glossary.html">Glossary</a></li>
    <li><a href="http://cyclus.github.com/basics/roadmap.html">Roadmap</a></li>
    <li><a href="http://cnergdata.engr.wisc.edu/cyclus/develop/docs/">Code Documentation</a></li>
    
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="writing-tests-for-modules">
<h1>Writing Tests for Modules<a class="headerlink" href="#writing-tests-for-modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Writing tests for your module is a prerequisite for its addition to
any <em>Cyclus</em> library. Specifically, any public API functionality must
provide the <a class="reference external" href="http://en.wikipedia.org/wiki/Exception_guarantees">basic guarantee</a>; however, you
may (and I do) find it useful to test private methods and the effect
of public methods on private members. This guide will provide an
example of how to achieve such functionality.</p>
</div>
<div class="section" id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<p>A fully developed module will have the following directory structure:</p>
<blockquote>
<div><ul class="simple">
<li>Module.h</li>
<li>Module.cpp</li>
<li>Module.rng</li>
<li>ModuleTests.h</li>
<li>ModuleTests.cpp</li>
<li>CMakeLists.txt</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="testing-framework">
<h2>Testing Framework<a class="headerlink" href="#testing-framework" title="Permalink to this headline">¶</a></h2>
<p><em>Cyclus</em> makes use of the <a class="reference external" href="http://code.google.com/p/googletest/">Google Test</a> framework. For each module
in <em>Cyclus</em>, a series of test fixtures are run. A test fixture is
defined by a macro, e.g.:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">TEST_F</span><span class="p">(</span><span class="n">ModuleTest</span><span class="p">,</span><span class="n">TestSomeFunctionality</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// for example, let us assume a variable begins in a false state,</span>
  <span class="c1">// a function is called, and we expect that variable to end in</span>
  <span class="c1">// a true state</span>
  <span class="n">EXPECT_FALSE</span><span class="p">(</span><span class="n">some_var_</span><span class="p">);</span>
  <span class="n">callSomeFunction</span><span class="p">();</span>
  <span class="n">EXPECT_TRUE</span><span class="p">(</span><span class="n">some_var_</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In addition to test fixtures, one must define:</p>
<blockquote>
<div><ul class="simple">
<li>a SetUp() function</li>
<li>a TearDown() function</li>
</ul>
</div></blockquote>
<p>When executed, the testing framework will run each test fixture
independently. For each fixture, Google Test does the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Run SetUp()</li>
<li>Run ModuleTest Fixture</li>
<li>Run TearDown()</li>
</ol>
</div></blockquote>
<p>It is the responsibility of the developer to properly initialize any
required members in SetUp() and free the appropriate memory in
TearDown().</p>
</div>
<div class="section" id="an-example">
<h2>An Example<a class="headerlink" href="#an-example" title="Permalink to this headline">¶</a></h2>
<p>Now we will provide an example of a very simple module. The module
increases a privately stored counter.</p>
<div class="section" id="module-h">
<h3>Module.h<a class="headerlink" href="#module-h" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Module</span><span class="p">;</span>
<span class="cp">#include &quot;ModuleTests.h&quot;</span>

<span class="k">class</span> <span class="nc">Module</span> <span class="p">{</span>
 <span class="k">public</span><span class="o">:</span>
  <span class="n">Module</span><span class="p">();</span>                 <span class="c1">// constructor</span>
  <span class="kt">void</span> <span class="n">increaseCounter</span><span class="p">();</span>   <span class="c1">// increase counter_ by one</span>

 <span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">counter_</span><span class="p">;</span>

  <span class="k">friend</span> <span class="k">class</span> <span class="nc">ModuleTest</span><span class="p">;</span>  <span class="c1">// friend class gives access to private members</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here we use the friend keyword. This allows functions defined in the
ModuleTest class to access both private and protected members and
methods of the Module class.</p>
</div>
<div class="section" id="module-cpp">
<h3>Module.cpp<a class="headerlink" href="#module-cpp" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;Module.h&quot;</span>

<span class="c1">// -----------------------------------------------------------------</span>
<span class="n">Module</span><span class="o">::</span><span class="n">Module</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">counter_</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// -----------------------------------------------------------------</span>
<span class="kt">void</span> <span class="n">Module</span><span class="o">::</span><span class="n">increaseCounter</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">counter_</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="moduletests-h">
<h3>ModuleTests.h<a class="headerlink" href="#moduletests-h" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;gtest/gtest.h&gt;</span>
<span class="cp">#include &quot;Module.h&quot;</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="k">class</span> <span class="nc">ModuleTest</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span> <span class="p">{</span>
<span class="k">protected</span><span class="o">:</span>
  <span class="n">Module</span><span class="o">*</span> <span class="n">module_</span><span class="p">;</span>

  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">SetUp</span><span class="p">();</span>     <span class="c1">// gtest construction</span>
  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">TearDown</span><span class="p">();</span>  <span class="c1">// gtest destruction</span>

  <span class="kt">int</span> <span class="n">counter</span><span class="p">();</span>            <span class="c1">// access the counter_ variable</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="moduletests-cpp">
<h3>ModuleTests.cpp<a class="headerlink" href="#moduletests-cpp" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;ModuleTests.h&quot;</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">SetUp</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">module_</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Module</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">TearDown</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">delete</span> <span class="n">module_</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">int</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">counter</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">module_</span><span class="o">-&gt;</span><span class="n">counter_</span><span class="p">;</span> <span class="c1">// counter_ accessed via friend class</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">TEST_F</span><span class="p">(</span><span class="n">ModuleTest</span><span class="p">,</span><span class="n">TestConstructor</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">counter</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">TEST_F</span><span class="p">(</span><span class="n">ModuleTest</span><span class="p">,</span><span class="n">TestIncreaseCounter</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">module_</span><span class="o">-&gt;</span><span class="n">increaseCounter</span><span class="p">();</span>
  <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">counter</span><span class="p">(),</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note here that we first test that the counter has been properly
initialized in the Module&#8217;s constructor. Second, we test that
increaseCounter() performs as expected. We need not test that the
counter&#8217;s value is 0 in TestIncreaseCounter because this has been
determined in TestConstructor.</p>
</div>
</div>
<div class="section" id="testing-xml-initialization">
<h2>Testing XML Initialization<a class="headerlink" href="#testing-xml-initialization" title="Permalink to this headline">¶</a></h2>
<p><em>Cyclus</em> relies on reading xml files to initialize modules. It is
often very convenient to test that a module has been initalized
correctly. The following example will show how to achieve such
functionality.</p>
<p>Let us return to the Module example; however, this time let us assume
that the initial value of the counter is determined at run time by
reading an XML file. For example, let us say the XML is as follows:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;counter_init&gt;</span>5<span class="nt">&lt;/counter_init&gt;</span>
</pre></div>
</div>
<p>Here the counter is initialized to the value 5. Let us revisit each
file to review what has changed to test this new functionality.</p>
<div class="section" id="id1">
<h3>Module.h<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Module</span><span class="p">;</span>
<span class="cp">#include &quot;ModuleTests.h&quot;</span>
<span class="cp">#include &lt;libxml/xpath.h&gt;</span>

<span class="k">class</span> <span class="nc">Module</span> <span class="p">{</span>
 <span class="k">public</span><span class="o">:</span>
  <span class="n">init</span><span class="p">(</span><span class="n">xmlNodePtr</span> <span class="n">cur</span><span class="p">,</span> <span class="n">xmlXPathContextPtr</span> <span class="n">context</span><span class="p">);</span>   <span class="c1">// initialize counter_</span>
  <span class="kt">void</span> <span class="n">increaseCounter</span><span class="p">();</span>                             <span class="c1">// increase counter_ by one</span>

 <span class="k">private</span><span class="o">:</span>
  <span class="kt">int</span> <span class="n">counter_</span><span class="p">;</span>

  <span class="k">friend</span> <span class="k">class</span> <span class="nc">ModuleTest</span><span class="p">;</span>  <span class="c1">// friend class gives access to private members</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Module.cpp<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;Module.h&quot;</span>
<span class="cp">#include &quot;InputXML.h&quot;</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">Module</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">xmlNodePtr</span> <span class="n">cur</span><span class="p">,</span> <span class="n">xmlXPathContextPtr</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">counter_</span> <span class="o">=</span>
    <span class="n">atoi</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span>
         <span class="n">XMLinput</span><span class="o">-&gt;</span><span class="n">get_xpath_content</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="n">node</span><span class="p">,</span><span class="s">&quot;counter_init&quot;</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// -----------------------------------------------------------------</span>
<span class="kt">void</span> <span class="n">Module</span><span class="o">::</span><span class="n">increaseCounter</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">counter_</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The counter_ variable is now initialized via XML. Specifically, an
XML node and context must be provided. Normally in <em>Cyclus</em>, the
XML context is provided via the XMLinput singleton.</p>
</div>
<div class="section" id="id3">
<h3>ModuleTests.h<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;Module.h&quot;</span>

<span class="cp">#include &lt;gtest/gtest.h&gt;</span>
<span class="cp">#include &lt;libxml/parser.h&gt;</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="k">class</span> <span class="nc">ModuleTest</span> <span class="o">:</span> <span class="k">public</span> <span class="o">::</span><span class="n">testing</span><span class="o">::</span><span class="n">Test</span> <span class="p">{</span>
<span class="k">protected</span><span class="o">:</span>
  <span class="n">Module</span><span class="o">*</span> <span class="n">module_</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">test_counter_</span><span class="p">;</span>        <span class="c1">// a variable to set the initialized counter to</span>

  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">SetUp</span><span class="p">();</span>     <span class="c1">// gtest construction</span>
  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">TearDown</span><span class="p">();</span>  <span class="c1">// gtest destruction</span>

  <span class="n">xmlDocPtr</span> <span class="n">getXMLDoc</span><span class="p">();</span>    <span class="c1">// get an xml doc from an xml snippet</span>
  <span class="kt">void</span> <span class="n">initModule</span><span class="p">();</span>        <span class="c1">// initialize the module</span>
  <span class="kt">int</span> <span class="n">counter</span><span class="p">();</span>            <span class="c1">// access the counter_ variable</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We can now test the counter_ variable at run time via the test_counter_
variable. We additionally encapsulate the module initalization process
in the initModule() function which will use the getXMLDoc() function
to provide the required XML node and context.</p>
</div>
<div class="section" id="id4">
<h3>ModuleTests.cpp<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;ModuleTests.h&quot;</span>

<span class="cp">#include &lt;libxml/parser.h&gt;</span>
<span class="cp">#include &lt;libxml/xpath.h&gt;</span>

<span class="cp">#include &lt;string&gt;</span>
<span class="cp">#include &lt;sstream&gt;</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">SetUp</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">module_</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Module</span><span class="p">();</span>
  <span class="n">test_counter_</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>      <span class="c1">// initialize test_counter_ to some value</span>
  <span class="n">initModule</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">TearDown</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">delete</span> <span class="n">module_</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">xmlDocPtr</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">getXMLDoc</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">stringstream</span> <span class="n">ss</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>

  <span class="c1">// get an xml snippet to test using the test_counter_ variable</span>
  <span class="n">ss</span> <span class="o">&lt;&lt;</span>
    <span class="s">&quot;&lt;?xml version=</span><span class="se">\&quot;</span><span class="s">1.0</span><span class="se">\&quot;</span><span class="s">?&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span>
    <span class="s">&quot;&lt;document&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span>
    <span class="s">&quot;  &lt;counter_init&gt;&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">test_counter_</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&lt;/counter_init&gt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span>
    <span class="s">&quot;&lt;/document&gt;&quot;</span><span class="p">;</span>

  <span class="c1">// return an xmlDocPtr to that snippet</span>
  <span class="n">string</span> <span class="n">snippet</span> <span class="o">=</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">xmlParseMemory</span><span class="p">(</span><span class="n">snippet</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="n">snippet</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">void</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">initModule</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">xmlDocPtr</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">getXMLDoc</span><span class="p">();</span>
  <span class="n">xmlXPathContextPtr</span> <span class="n">context</span> <span class="o">=</span> <span class="n">xmlXPathNewContext</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">xmlNodePtr</span> <span class="n">node</span> <span class="o">=</span> <span class="n">doc</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">;</span>

  <span class="n">module_</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="n">context</span><span class="p">);</span> <span class="c1">// initialize module_ using the xml snippet</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="kt">int</span> <span class="n">ModuleTest</span><span class="o">::</span><span class="n">counter</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">module_</span><span class="o">-&gt;</span><span class="n">counter_</span><span class="p">;</span> <span class="c1">// counter_ accessed via friend class</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">TEST_F</span><span class="p">(</span><span class="n">ModuleTest</span><span class="p">,</span><span class="n">TestInit</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">counter</span><span class="p">(),</span><span class="n">test_counter_</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="n">TEST_F</span><span class="p">(</span><span class="n">ModuleTest</span><span class="p">,</span><span class="n">TestIncreaseCounter</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">module_</span><span class="o">-&gt;</span><span class="n">increaseCounter</span><span class="p">();</span>
  <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">counter</span><span class="p">(),</span><span class="n">test_counter_</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With this update, the module_ will be initialized to test_counter_
each time SetUp() is called. We can therefore make tests that are
very similar to the previous example. The main difference is that we
compare agaisnt a variable initialized by our own test suite, i.e.
test_counter_, rather than hard-coding in a value, i.e. 0, as was
true in the previous example.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="logger.html" title="Using the Cyclus Logger"
             >next</a> |</li>
        <li class="right" >
          <a href="make-models/toaster.html" title="Model Devlopment Example : ToasterFacility"
             >previous</a> |</li>
        <li><a href="../index.html">Cyclus Home</a> &raquo;</li>
          <li><a href="main.html" >Cyclus Developer Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, University of Wisconsin Computational Nuclear Engineering Research Group.
      Last updated on Aug 20, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>